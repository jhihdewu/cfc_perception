# 1\. 在你看來，機器人在執行料理任務的過程中，有哪些關鍵性的 Perception 資訊是機器人必須精確掌握的？你會如何設計系統或方法來實作並有效獲取這些 Perception 資訊？ 

## 料理與Perception

中國菜烹調方法非常多，維基百科上就有列出10幾種。簡單分類可以分成水煮（燉）、油炸（煎）、蒸烤等等，從這三個分類出發，我們經常可以看到食譜中的指示有：

- 水煮（燉）

   - 將泡好的米和水/高湯放入鍋中，開大火煮滾……煮至米粒軟爛，粥的濃稠度適中即可。（皮蛋瘦肉粥）

- 油（炸、煎、炒）

   - 鍋中留少許油，放入鹹蛋黃碎，中小火炒至起泡，加入蒜末、蔥白炒香。（金沙豆腐）

   - 熱鍋下油，放入醃製好的雞丁，炒至變色後盛起備用. （宮保雞丁）

- 蒸烤

   - 燒開一鍋水，將魚放進去大火蒸 8 分鐘，開蓋取出魚身與肚子裡的薑片與蔥段，再撈出多餘魚湯，均勻淋上醬油，大火續蒸 5 分鐘，至魚熟了即可取出

<br>

除了面向一般大眾的食譜外，有經驗的廚師也可以善加利用其他的感官，例如在[成為更好的廚師：善用感官的九種方法](https://nommagazine.com/%E6%88%90%E7%82%BA%E6%9B%B4%E5%A5%BD%E7%9A%84%E5%BB%9A%E5%B8%AB%EF%BC%9A%E5%96%84%E7%94%A8%E6%84%9F%E5%AE%98%E7%9A%84%E4%B9%9D%E7%A8%AE%E6%96%B9%E6%B3%95/)文中提到以下的例子：

- 聽鍋裡滋滋作響的聲音是否平穩來判斷油溫高低

- 聽液體滾動的聲音，判斷微滾、滾、沸騰大滾時的差別

- 知道麵粉與水份搭配比例剛好的觸感

- 考蛋糕時候，還沒好的會發出細微的啵啵聲，烤熟的蛋糕則不會有聲音。

<br>

從上面的幾個範例中可以看到，Perception是判斷何時該進行下一步或是料理目前處於那一個階段的關鍵，從上面的範例我們可以簡單列出幾項：

- 溫度

   - 大火、小火

   - 鍋子熱好了沒

   - 油溫到了沒

   - 水煮滾了沒

- 視覺

   - 炒至變色了沒、變色的程度

   - 煮至米粒軟爛

   - 中小火炒至起泡

- 聽覺

   - 煎、炒、烤與煮時不同聲響的意義

- 嗅覺

   - 爆香味道的程度

   - 有沒有焦味

- 觸覺

   - 黃金比例麵團的觸感

   - 酥脆恰到好處的觸感


<br>
從上面的例子可以看到，視覺、聽覺、嗅覺、觸覺與溫度等都在料理過程中佔有一席之地，理論上如果這些資料都能完美地被蒐集那絕對是最好的，但現實還得考量sensor的價格、資料處理的難度、資料應用的難度等等。例如，透過e-noise來判斷爆香程度直覺上感覺可行，但還得考慮到廚房中不同的氣味之間的互相干擾；又或著是說透過觸覺來判斷粥是否煮的恰到好處好像很棒，但是還得考慮到sensor的耐熱程度以及與食材接觸後的清潔問題等，其中更大的挑戰是這些sensor的價格通常也是相對比較高。


<br><br>
綜合以上的討論，我認為熱影像、溫度計、相機與麥克風是在sensor的價格、資料處理的難度、資料應用的難度上都具有相當可行性。

## 有效獲取Perception資訊的系統與方法

### 以”鍋子熱好了沒”例：

**輸入**：熱影像與鍋子的mask

**處理**：透過OpenCV，首先使用人工定義的bounding box只留下可能出現鍋子的區域，再透過鍋子的Segmentation Mask精確刪除不是鍋子的部份來增加辨之後計算精確性。

**計算**：計算鍋子的平均溫度與標準差，當平均溫度到達目標問度且標準差小於某一程度時，即表示鍋子已經熱好了而且受熱均勻。

**輸出**：鍋子的平均溫度、標準差以及是否ready

<br>

### 以”變色了沒為”例：

**輸入**：rgb影像與鍋子或目標烹煮物的mask

**處理**：透過OpenCV，首先使用人工定義的bounding box只留下可能出現鍋子或目標烹煮物的區域，再透過鍋子的Segmentation Mask精確刪除不是鍋子或目標烹煮物的部份來增加辨識的速度。

**計算**：透過深度學習模型對目標烹煮物之圖片進行Classification

**輸出**：變色程度。例如1分熟、9分熟或是煮過頭等（依料理特性設計），不使用boolean是因為食材在烹調過程中的顏色變化是一個連的過程，只用boolean可能會讓刻度太小不利操作，例如有些烹調過程是要在食材漸熟的過程中進行，或是一不小心反而煮過頭。

**模型選擇**：由於有時從快煮好到煮過頭可能只有很短的時間，使用的模型必須要夠快，所以可能不適合使用vlm，我會優先考慮使用Yolo系列。但是標注資料則可使用vlm來輔助。

**更好的作法**：前面有提到食材在烹調過程中的顏色變化是一個連的過程，上面的作法並未考慮到這種特性，所以更好的模型選擇應該要是LSTM或是使用某種Enocder來產生cls token。

<br>

### 以”聽鍋裡滋滋作響的聲音是否平穩來判斷油溫高低”例：

**輸入**：音訊

**處理**：轉換成頻譜圖

**計算**：透過深度學習模型對頻譜圖進行Classification

**輸出**：分成加熱中、煎、炸、溫度過高。

**模型選擇**：如果這個油溫判斷是用在即時性很強的情境，則如之前提到要使用注重Inference速度的模性如Yolo，

其他作法：直接使用溫度計、熱影像或許更直覺（但使用聲音辨識可作為一個當溫度計失靈、油煙過大熱影像失準時的方備案）





